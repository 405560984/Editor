var __extends=this&&this.__extends||function(e,t){function s(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)},BABYLON;!function(e){var t;!function(t){var s;!function(t){var s=function(){function t(){}return t.LoadExtensionsFile=function(s,n){e.Tools.LoadFile(s,function(e){t._ExtensionsDatas=JSON.parse(e),n()})},t.GetExtensionData=function(e){return t._ExtensionsDatas[e]?t._ExtensionsDatas[e]:null},t.ApplyExtensions=function(e){for(var s=0;s<t._Extensions.length;s++){var n=new t._Extensions[s](e),i=t.GetExtensionData(n.extensionKey);(i||!i&&n.applyEvenIfDataIsNull)&&n.apply(i)}},t.RegisterExtension=function(e){t._Extensions.push(e)},t._Extensions=[],t}();t.EditorExtension=s}(s=t.EXTENSIONS||(t.EXTENSIONS={}))}(t=e.EDITOR||(e.EDITOR={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(t){var s;!function(t){e.Effect.ShadersStore.editorTemplatePixelShader=["varying vec2 vUV;","uniform sampler2D textureSampler; // Previous post-process","uniform sampler2D originalSampler; // Original scene color","","// uniform sampler2D mySampler; // From JSON configuration","","uniform vec2 screenSize; // Automatic","uniform float exposure; // From JSON configuration","","void main(void) ","{","    gl_FragColor=texture2D(originalSampler, vUV) * exposure;","}"].join("\n");var s=function(){function t(t){this.extensionKey="PostProcessBuilder",this.applyEvenIfDataIsNull=!1,this.placeHolderTexture=null,this._scenePassPostProcess=null,this._postProcesses=[],this._scene=t;var s={name:"PassPostProcessExtension",id:"PostProcessEditorExtensionPassPostProcess",program:e.Effect.ShadersStore.editorTemplatePixelShader,configuration:JSON.stringify({ratio:1,defines:[],uniforms:[{name:"exposure",value:1}],samplers:[]})};this.applyPostProcess(s),this._scenePassPostProcess=s.postProcess}return t.prototype.apply=function(e){for(var t=0;t<e.length;t++)this.applyPostProcess(e[t])},t.prototype.removePostProcess=function(e){for(var t=0;t<this._scene.cameras.length;t++)this._scene.cameras[t].detachPostProcess(e);e.dispose();var s=this._postProcesses.lastIndexOf(e);s!==-1&&this._postProcesses.splice(s,1)},t.prototype.applyPostProcess=function(t){var s=t.name+"_"+t.id;e.Effect.ShadersStore[s+"PixelShader"]=t.program;var n=["screenSize"],i=["originalSampler"],a=JSON.parse(t.configuration);a.ratio=a.ratio||1,a.defines=a.defines||[],a.uniforms=a.uniforms||[],a.samplers=a.samplers||[];for(var o=0;o<a.uniforms.length;o++){var r=a.uniforms[o],c=a.uniforms[o].value;c instanceof Array||"number"==typeof c?n.push(r.name):(e.Tools.Warn("PostProcessExtension -- Uniform named "+r.name+" has an unknown value type of post-process "+t.name),a.uniforms.splice(o,1),o--)}for(var o=0;o<a.samplers.length;o++){for(var h=a.samplers[o],p=0;p<this._scene.textures.length;p++)if(this._scene.textures[p].name===h.source){h.object=this._scene.textures[p];break}for(var p=0;p<this._postProcesses.length;p++)if(this._postProcesses[p].name===h.source){h.object=this._postProcesses[p];break}h.object?i.push(h.uniform):(e.Tools.Warn("PostProcessExtension -- Sampler named "+h.uniform+" hasn't been found in textures and post-processes in the post-process "+t.name),a.samplers.splice(o,1),o--)}for(var l=[],o=0;o<a.defines.length;o++)l.push("#define "+a.defines[o]+"\n");t.postProcess=new e.PostProcess(t.name,s,n,i,a.ratio/devicePixelRatio,null,e.Texture.BILINEAR_SAMPLINGMODE,this._scene.getEngine(),(!1),l.join()),t.postProcess.onApply=this._postProcessCallback(t.postProcess,a);for(var o=0;o<this._scene.cameras.length;o++)this._scene.cameras[o].attachPostProcess(t.postProcess);this._postProcesses.push(t.postProcess)},t.prototype._postProcessCallback=function(t,s){var n=this,i=e.Vector2.Zero();return function(a){n.placeHolderTexture?a.setTexture("originalSampler",n.placeHolderTexture):a.setTextureFromPostProcess("originalSampler",n._scenePassPostProcess),i.x=t.width,i.y=t.height,a.setVector2("screenSize",i);for(var o=0;o<s.uniforms.length;o++){var r=s.uniforms[o].value;r instanceof Array?a.setArray(s.uniforms[o].name,r):a.setFloat(s.uniforms[o].name,r)}for(var o=0;o<s.samplers.length;o++){var c=s.samplers[o].object;c instanceof e.BaseTexture?a.setTexture(s.samplers[o].uniform,c):a.setTextureFromPostProcess(s.samplers[o].uniform,c)}}},t}();t.PostProcessBuilderExtension=s,t.EditorExtension.RegisterExtension(s)}(s=t.EXTENSIONS||(t.EXTENSIONS={}))}(t=e.EDITOR||(e.EDITOR={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(t){var s;!function(t){var s=function(){function t(e){this.extensionKey="Cosmos",this.applyEvenIfDataIsNull=!1,this.distanceToRoot=1e3,this.distanceToFunction=5,this.heightFromRoot=5,this.functionsDistance=1,this.animationsDistance=5,this.sphereDiameter=1,this._galaxies=[],this._sphereMesh=null,this._scene=e}return t.prototype.apply=function(s){if(s)for(var n in s)this[n]=s[n];this._sphereMesh=e.Mesh.CreateSphere("SphereRoot",32,this.sphereDiameter,this._scene),this._sphereMesh.id="root",this._cameraTarget=new e.Mesh("CameraTarget",this._scene),this._scene.activeCamera.lockedTarget=this._cameraTarget;for(var i=[],a=0;a<t._BotDatas.groups.length;a++)i.push(t._BotDatas.groups[a].title);var o=this._createCosmosGalaxy("CosmosRootLinesMesh",e.Vector3.Zero(),i,1,!1);this._galaxies.push(o);for(var a=0;a<t._BotDatas.groups.length;a++){var r=t._BotDatas.groups[a];i=[];for(var c=0;c<r.functions.length;c++)i.push(r.functions[c].title);var h=this._createCosmosGalaxy(r.title,o.nodes[a].position.clone(),i,this.functionsDistance,!0);this._galaxies.push(h)}this.animateCameraToId("root")},t.prototype.reset=function(){this._sphereMesh&&this._sphereMesh.dispose(),this._cameraTarget&&(this._scene.activeCamera.lockedTarget=null,this._cameraTarget.dispose());for(var e=0;e<this._galaxies.length;e++){for(var t=0;t<this._galaxies[e].nodes.length;t++)this._galaxies[e].nodes[t].dispose();this._galaxies[e].mesh&&this._galaxies[e].mesh.dispose(),this._galaxies[e].mesh=null,this._galaxies[e].nodes=[],this._galaxies[e].positionToRoot=null}this._galaxies=[]},t.prototype.updateMeshes=function(){for(var t=0;t<this._galaxies.length;t++){for(var s=this._galaxies[t],n=[s.positionToRoot.clone()],i=0;i<s.nodes.length;i++){var a=s.nodes[i];n.push(a.position.clone()),n.push(s.positionToRoot.clone())}s.mesh=e.Mesh.CreateLines(s.name,n,this._scene,!0,s.mesh),s.sphereInstance||(s.sphereInstance=this._sphereMesh.createInstance("SphereInstance"+t+"_"+i),s.sphereInstance.position=s.positionToRoot.clone())}},t.prototype.animateCameraToId=function(t){for(var s=0;s<this._scene.meshes.length;s++)if(this._scene.meshes[s].id===t){var n=this._scene.meshes[s].position,i=new e.SineEase;i.setEasingMode(e.EasingFunction.EASINGMODE_EASEINOUT);var a=new e.Animation("PositionAnimation","position",24,e.Animation.ANIMATIONTYPE_VECTOR3,e.Animation.ANIMATIONLOOPMODE_CYCLE);a.setEasingFunction(i),a.setKeys([{frame:0,value:this._scene.activeCamera.position},{frame:24,value:n.add(new e.Vector3(15,15,15))}]);var o=new e.Animation("PositionAnimation","position",12,e.Animation.ANIMATIONTYPE_VECTOR3,e.Animation.ANIMATIONLOOPMODE_CYCLE);o.setEasingFunction(i),o.setKeys([{frame:0,value:this._scene.activeCamera.getTarget()},{frame:24,value:n}]),this._scene.activeCamera.animations.push(a),this._cameraTarget.animations.push(o),this._scene.beginAnimation(this._scene.activeCamera,0,24,!1,1),this._scene.beginAnimation(this._cameraTarget,0,24,!1,1);break}},t.prototype._createCosmosGalaxy=function(t,s,n,i,a){for(var o={name:t,nodes:[],positionToRoot:s,mesh:null,sphereInstance:null},r=1,c=0;c<n.length;c++){var h=c*Math.PI*2/n.length,p=new e.Vector3((this._galaxies.length?this.distanceToFunction:this.distanceToRoot)*Math.cos(h),(this.heightFromRoot+this.distanceToFunction)/2*Math.random()*r,(this._galaxies.length?this.distanceToFunction:this.distanceToRoot)*Math.sin(h)).add(s);p=p.multiply(new e.Vector3(i,i,i));var l=null;if(a){l=e.Mesh.CreatePlane(t+"_animatedMesh_"+c,5,this._scene),l.billboardMode=e.Mesh.BILLBOARDMODE_ALL;var u=new e.DynamicTexture(t+"_animatedMeshTexture_"+c,{width:1024,height:1024},this._scene,(!0));u.drawText(n[c],null,512,"bold 60px verdana","white","transparent"),u.hasAlpha=!0,u.update(!0);var m=new e.StandardMaterial(t+"_animatedMeshMaterial_"+c,this._scene);m.diffuseTexture=u,l.material=m}else l=new e.Mesh(t+"_animatedMesh_"+c,this._scene);if(l.id=n[c],l.position=p,o.nodes.push(l),a){var _=new e.SineEase;_.setEasingMode(e.EasingFunction.EASINGMODE_EASEINOUT);var v=new e.Animation(t+"_animation_"+c,"position",24,e.Animation.ANIMATIONTYPE_VECTOR3,e.Animation.ANIMATIONLOOPMODE_CYCLE);v.setEasingFunction(_);for(var f=[],d=0;d<4;d++)f.push({frame:d,value:new e.Vector3(p.x+Math.random()*this.animationsDistance,p.y+Math.random()*this.animationsDistance,p.z+Math.random()*this.animationsDistance)});f.push({frame:4,value:f[0].value.clone()}),v.setKeys(f),l.animations.push(v),this._scene.beginAnimation(l,0,4,!0,.01)}r*=-1}return o},t.prototype._loadBotDatas=function(s){t._BotDatas?s(t._BotDatas):e.Tools.LoadFile("website/resources/bot.json",function(e){t._BotDatas=JSON.parse(e),s(t._BotDatas)})},t}();t.CosmosExtension=s,t.EditorExtension.RegisterExtension(s)}(s=t.EXTENSIONS||(t.EXTENSIONS={}))}(t=e.EDITOR||(e.EDITOR={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(t){var s;!function(t){var s=function(){function t(e,t){this._events={},this.scene=e,this.namespace=t}return t.prototype.onEvent=function(t,s){var n=this._events[t];n&&e.Tools.Warn('The event "'+t+" already exists. It has been replaces"),this._events[t]=s},t.prototype.removeEvent=function(e){return!!this._events[e]&&(delete this._events[e],!0)},t.prototype.callEvent=function(e){if("*"===e.eventName)for(var t in this._events)this._events[t](e.eventData);else{var s=this._events[e.eventName];s&&s(e.eventData)}},t.SendEvent=function(e,t){if("*"===t.eventName)for(var s in this._EventReceivers)for(var n=this._EventReceivers[s],i=0;i<n.length;i++)n[i].callEvent(t);else{var n=this._EventReceivers[e];if(!n)return;for(var i=0;i<n.length;i++)n[i].callEvent(t)}},t.RegisterEventListener=function(e){var t=this._EventReceivers[e.namespace];t?t.push(e):this._EventReceivers[e.namespace]=[e]},t._EventReceivers={},t}();t.DevelopmentBaseExtension=s}(s=t.EXTENSIONS||(t.EXTENSIONS={}))}(t=e.EDITOR||(e.EDITOR={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,s,n){e.call(this,t,n),this._particleSystem=s}return __extends(t,e),t.prototype._prepare=function(){},t.prototype.execute=function(){void 0!==this._particleSystem&&this._particleSystem.start()},t.prototype.serialize=function(t){return e.prototype._serialize.call(this,{name:"StartParticleSystemAction",properties:[{name:"particleSystem",value:this._particleSystem?this._particleSystem.id:""}]},t)},t}(e.Action);e.StartParticleSystemAction=t;var s=function(e){function t(t,s,n){e.call(this,t,n),this._particleSystem=s}return __extends(t,e),t.prototype._prepare=function(){},t.prototype.execute=function(){void 0!==this._particleSystem&&this._particleSystem.stop()},t.prototype.serialize=function(t){return e.prototype._serialize.call(this,{name:"StopParticleSystemAction",properties:[{name:"particleSystem",value:this._particleSystem?this._particleSystem.id:""}]},t)},t}(e.Action);e.StopParticleSystemAction=s}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=["{",'   eventName: "myEvent",',"   eventData: {","       ","   }","}"].join("\n"),s=function(s){function n(e,n,i,a,o){void 0===a&&(a=t),s.call(this,e,o),this._namespace=n,this._eventName=i,this._data=JSON.parse(a)}return __extends(n,s),n.prototype._prepare=function(){},n.prototype.execute=function(){e.EDITOR.EXTENSIONS.DevelopmentBaseExtension.SendEvent(this._namespace,{eventName:this._eventName,eventData:this._data})},n.prototype.serialize=function(e){return s.prototype._serialize.call(this,{name:"SendDevelopmentEventAction",properties:[{name:"namespace",value:this._namespace},{name:"eventName",value:this._eventName},{name:"data",value:JSON.stringify(this._data)}]},e)},n}(e.Action);e.SendDevelopmentEventAction=s}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function s(e,s,n,i){t.call(this,e,i),this._target=s,this._value=n}return __extends(s,t),s.prototype._prepare=function(){},s.prototype.execute=function(){this._target instanceof e.AbstractMesh&&this._target.getPhysicsImpostor()&&this._target.applyImpulse(this._value,e.Vector3.Zero())},s.prototype.serialize=function(s){return t.prototype._serialize.call(this,{name:"ApplyImpulseAction",properties:[e.Action._GetTargetProperty(this._target),{name:"value",value:this._value.x+", "+this._value.y+", "+this._value.z}]},s)},s}(e.Action);e.ApplyImpulseAction=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,s){e.call(this,t),this._started=!1,this._finished=!1,this._value=s}return __extends(t,e),t.prototype.isValid=function(){var e=this;this._started||(this._started=!0,setTimeout(function(){return e._finished=!0},this._value));var t=this._finished;return this._finished&&(this._finished=!1,this._started=!1),t},t.prototype.serialize=function(){return this._serialize({name:"TimerCondition",properties:[{name:"value",value:this._value}]})},t}(e.Condition);e.TimerCondition=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function s(s,n,i,a){void 0===a&&(a=e.ValueCondition.IsEqual),t.call(this,s),this._target=n,this._distance=i,this._operator=a}return __extends(s,t),s.prototype.isValid=function(){var t=this._actionManager.getScene();if(t.activeCamera&&this._target&&this._target.position){var s=e.Vector3.Distance(this._actionManager.getScene().activeCamera.position,this._target.position);switch(this._operator){case e.ValueCondition.IsGreater:return s>this._distance;case e.ValueCondition.IsLesser:return s<this._distance;case e.ValueCondition.IsEqual:case e.ValueCondition.IsDifferent:var n=n=this._distance===s;return this._operator===e.ValueCondition.IsEqual?n:!n}}return!1},s.prototype.serialize=function(){return this._serialize({name:"DistanceToCameraCondition",properties:[e.Action._GetTargetProperty(this._target),{name:"value",value:this._distance}]})},s}(e.Condition);e.DistanceToCameraCondition=t}(BABYLON||(BABYLON={}));