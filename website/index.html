<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Babylon.js Editor</title>

    <!-- STYLE -->
    <link rel="stylesheet" type="text/css" href="../css/w2ui-1.4.1.css" />
    <link rel="stylesheet" type="text/css" href="../css/babylon.editor.css" />

</head>
<body>

    <div id="BABYLON-EDITOR-MAIN" style="width: 100%; height: 100%"></div>

    <!-- LIBS -->
    <script src="../libs/babylon.max.js" type="text/javascript"></script>
    <script src="../libs/jquery.min.js" type="text/javascript"></script>
    <script src="../libs/w2ui-1.4.1.js" type="text/javascript"></script>

    <!-- GUI ELEMENTS -->
    <script src="../sources/gui/babylon.editor.guiElement.js" type="text/javascript"></script>
    <script src="../sources/gui/babylon.editor.guiPanel.js" type="text/javascript"></script>
    <script src="../sources/gui/babylon.editor.guiLayouts.js" type="text/javascript"></script>
    <script src="../sources/gui/babylon.editor.guiForm.js" type="text/javascript"></script>

    <!-- EVENTS -->
    <script src="../sources/internal/babylon.editor.event.js" type="text/javascript"></script>

    <!-- MAIN FILES -->
    <script src="../sources/babylon.editor.main.js" type="text/javascript"></script>
    <script src="../sources/babylon.editor.core.js" type="text/javascript"></script>

    <!-- EDITION TOOLS -->
    <script src="../sources/babylon.editor.editionTool.js" type="text/javascript"></script>
    <script src="../sources/editionTools/babylon.editor.general.js" type="text/javascript"></script>

    <script type="text/javascript">
        
        var editorMain = new BABYLON.EDITOR.EditorMain("BABYLON-EDITOR-MAIN");
        var core = editorMain.core;

        core.engine.runRenderLoop(function () {
            editorMain.update();
        });

        // Create test scene
        function createReleaseScene() {
            function createMaterial(name, path) {
                var material = new BABYLON.StandardMaterial(name, core.currentScene);
                material.diffuseColor = new BABYLON.Color3(1, 1, 1);
                material.diffuseTexture = new BABYLON.Texture(path, core.currentScene);

                return material;
            }

            /// Light
            var light = new BABYLON.DirectionalLight("globalLight", new BABYLON.Vector3(-1, -2, -1), core.currentScene);
            light.position = new BABYLON.Vector3(10, 10, 0);
            var shadows = new BABYLON.ShadowGenerator(1024, light);

            var object = BABYLON.Mesh.CreateGround("New Ground", 60, 60, 20, core.currentScene);
            object.material = createMaterial("ground1m", "./Tests/textures/tile.jpg");
            object.material.diffuseTexture.uScale = 15.0;
            object.material.diffuseTexture.vScale = 15.0;
            object.material.reflectionTexture = new BABYLON.MirrorTexture("mirror", 512, core.currentScene, true);
            object.material.reflectionTexture.mirrorPlane = new BABYLON.Plane(0, -1.0, 0, 0.0);
            object.material.reflectionTexture.level = 0.6;
            object.isPickable = true;
            object.receiveShadows = true;

            var box = BABYLON.Mesh.CreateBox("New Cube", 1, core.currentScene, true);
            box.material = createMaterial("sphere1m", "./Tests/textures/diffuse.tga");
            box.material.normalTexture = new BABYLON.Texture("./Tests/textures/normal.tga", core.currentScene);
            box.scaling = new BABYLON.Vector3(4, 4, 4);
            box.position = new BABYLON.Vector3(0, 2, 0);
            shadows.getShadowMap().renderList.push(box);

            object.material.reflectionTexture.renderList = [box];

            var ev = new BABYLON.EDITOR.Event();
            ev.eventType = BABYLON.EDITOR.EventType.SCENE_EVENT;
            ev.sceneEvent = new BABYLON.EDITOR.SceneEvent(object, BABYLON.EDITOR.SceneEvent.OBJECT_PICKED);
            editorMain.editionTool.onEvent(ev);

        };
        createReleaseScene();

    </script>

</body>
</html>
